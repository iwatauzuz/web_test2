<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«è§£èª¬ã‚¹ãƒ©ã‚¤ãƒ‰ã‚·ãƒ§ãƒ¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Tailwind gray-100 */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden; /* ã‚¹ãƒ©ã‚¤ãƒ‰ã‚·ãƒ§ãƒ¼ã®ã‚³ãƒ³ãƒ†ãƒŠå¤–ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’é˜²ã */
        }
        .slideshow-container {
            background-color: white;
            width: 90%;
            max-width: 900px;
            height: 600px; /* å›ºå®šã®é«˜ã•ã‚’è¨­å®š */
            border-radius: 0.75rem; /* Tailwind rounded-xl */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); /* Tailwind shadow-xl */
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden; /* ã‚¹ãƒ©ã‚¤ãƒ‰å†…ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã¯ã¿å‡ºãªã„ã‚ˆã†ã« */
        }
        .slide {
            width: 100%;
            height: calc(100% - 60px); /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³åˆ†ã‚’å¼•ã„ãŸé«˜ã• */
            padding: 2rem;
            display: flex; /* å¸¸æ™‚flexã§ã€è¡¨ç¤ºåˆ¶å¾¡ã¯opacityã¨transform */
            pointer-events: none; /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯æ“ä½œä¸å¯ */
            z-index: 1; /* éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¹ãƒ©ã‚¤ãƒ‰ã®z-index */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0; /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯éè¡¨ç¤º (é€æ˜) */
            transition: opacity 0.7s ease-in-out, transform 0.7s ease-in-out;
            transform: translateX(100%); /* åˆæœŸä½ç½®ã‚’å³å¤–ã« */
        }
        .slide.active {
            opacity: 1; /* è¡¨ç¤º */
            transform: translateX(0); /* ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¹ãƒ©ã‚¤ãƒ‰ã¯ä¸­å¤®ã« */
            pointer-events: auto; /* ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¹ãƒ©ã‚¤ãƒ‰ã¯æ“ä½œå¯èƒ½ã« */
            z-index: 2; /* ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’æœ€å‰é¢ã« */
        }
        /* å·¦ã¸å‡ºã¦ã„ãã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®ã‚¯ãƒ©ã‚¹ */
        .slide.prev-transition {
            transform: translateX(-100%);
            opacity: 0; /* CSSãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³ã§é€æ˜ã«ãªã‚‹ */
            z-index: 1; /* active ã‚ˆã‚Šã¯å¾Œã‚ */
        }
        .slide h2 {
            font-size: 2rem; /* Tailwind text-3xl */
            font-weight: 700; /* Tailwind font-bold */
            color: #1e40af; /* Tailwind blue-800 */
            margin-bottom: 1rem;
        }
        .slide h3 {
            font-size: 1.5rem; /* Tailwind text-2xl */
            font-weight: 600; /* Tailwind font-semibold */
            color: #1d4ed8; /* Tailwind blue-700 */
            margin-bottom: 1.5rem;
        }
        .slide p {
            font-size: 1rem; /* Tailwind text-base */
            color: #374151; /* Tailwind gray-700 */
            line-height: 1.6;
            margin-bottom: 1rem;
            max-width: 600px;
        }
        .slide .keywords {
            font-size: 0.9rem;
            color: #4b5563; /* Tailwind gray-600 */
            background-color: #e5e7eb; /* Tailwind gray-200 */
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            display: inline-block;
        }
        .slide .analogy {
            font-style: italic;
            color: #166534; /* Tailwind green-700 */
            background-color: #dcfce7; /* Tailwind green-100 */
            padding: 0.75rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            border-left: 4px solid #22c55e; /* Tailwind green-500 */
        }

        .navigation-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            background-color: #f9fafb; /* Tailwind gray-50 */
            border-top: 1px solid #e5e7eb; /* Tailwind gray-200 */
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 60px; /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®é«˜ã•ã‚’å›ºå®š */
        }
        .nav-button {
            padding: 0.5rem 1.5rem;
            background-color: #3b82f6; /* Tailwind blue-500 */
            color: white;
            border: none;
            border-radius: 0.5rem; /* Tailwind rounded-lg */
            font-size: 1rem;
            font-weight: 500; /* Tailwind font-medium */
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .nav-button:hover {
            background-color: #2563eb; /* Tailwind blue-600 */
        }
        .nav-button:disabled {
            background-color: #9ca3af; /* Tailwind gray-400 */
            cursor: not-allowed;
        }
        .slide-counter {
            font-size: 0.9rem;
            color: #4b5563; /* Tailwind gray-600 */
        }

        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .data-flow-animation {
            width: 100%;
            height: 250px;
            position: relative;
            margin-top: 1.5rem;
            border: 1px solid #d1d5db; /* Tailwind gray-300 */
            border-radius: 0.5rem;
            overflow: hidden; /* ãƒ‘ã‚±ãƒƒãƒˆãŒã¯ã¿å‡ºãªã„ã‚ˆã†ã« */
            background-image: linear-gradient(45deg, #e5e7eb 25%, transparent 25%),
                              linear-gradient(-45deg, #e5e7eb 25%, transparent 25%),
                              linear-gradient(45deg, transparent 75%, #e5e7eb 75%),
                              linear-gradient(-45deg, transparent 75%, #e5e7eb 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
        }
        .layer-box-container {
            display: flex;
            justify-content: space-around;
            width: 100%;
            height: 100%;
            position: absolute;
        }
        .layer-stack {
            display: flex;
            flex-direction: column-reverse; /* ä¸‹ã‹ã‚‰ä¸Šã«ç©ã‚€ */
            justify-content: space-around;
            align-items: center;
            height: 100%;
            padding: 10px 0;
        }
        .layer-box {
            font-size: 0.7rem;
            padding: 2px 6px;
            border: 1px solid;
            border-radius: 4px;
            margin: 2px 0;
            width: 100px; /* å¹…ã‚’å›ºå®š */
            text-align: center;
            background-color: white;
        }
        .packet {
            width: 30px;
            height: 20px;
            background-color: #ef4444; /* Tailwind red-500 */
            border-radius: 4px;
            position: absolute;
            transition: top 1s ease-in-out, left 1s ease-in-out, opacity 0.5s ease-in-out; /* opacityã®transitionè¿½åŠ  */
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 0.7rem;
            font-weight: bold;
        }
        .packet.sender {
            /* åˆæœŸä½ç½®ã¯JSã§è¨­å®š */
        }
        .packet.receiver {
            /* åˆæœŸä½ç½®ã¯JSã§è¨­å®š */
        }

        /* å„å±¤ã®ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆç°¡æ˜“çš„ãªã‚‚ã®ï¼‰ */
        .layer-icon {
            font-size: 3rem; /* Tailwind text-5xl */
            margin-bottom: 1rem;
        }
        .icon-app { color: #ea580c; } /* Tailwind orange-600 */
        .icon-pres { color: #ca8a04; } /* Tailwind yellow-600 */
        .icon-sess { color: #65a30d; } /* Tailwind lime-600 */
        .icon-trans { color: #059669; } /* Tailwind emerald-600 */
        .icon-net { color: #0891b2; } /* Tailwind cyan-600 */
        .icon-data { color: #0284c7; } /* Tailwind sky-600 */
        .icon-phys { color: #4f46e5; } /* Tailwind indigo-600 */

    </style>
</head>
<body>
    <div class="slideshow-container">
        <div id="slide-content-area"></div>

        <div class="navigation-controls">
            <button id="prev-button" class="nav-button">æˆ»ã‚‹</button>
            <span id="slide-counter" class="slide-counter"></span>
            <button id="next-button" class="nav-button">æ¬¡ã¸</button>
        </div>
    </div>

    <script>
        // DEBUG: ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºã¦ã„ãªã„ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚
        console.log("Slideshow script started.");

        const slidesData = [
            {
                title: "OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«ã¸ã‚ˆã†ã“ãï¼",
                content: `
                    <p>OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«ã¯ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®æ©Ÿèƒ½ã‚’7ã¤ã®éšå±¤ã«åˆ†ã‘ã¦å®šç¾©ã—ãŸã‚‚ã®ã§ã™ã€‚</p>
                    <p>ã“ã‚Œã«ã‚ˆã‚Šã€ç•°ãªã‚‹ãƒ¡ãƒ¼ã‚«ãƒ¼ã®æ©Ÿå™¨åŒå£«ã§ã‚‚é€šä¿¡ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚å„å±¤ã¯ç‰¹å®šã®å½¹å‰²ã‚’æ‹…ã„ã€éš£æ¥ã™ã‚‹å±¤ã¨é€£æºã—ã¦å‹•ä½œã—ã¾ã™ã€‚</p>
                    <p class="mt-4">ã“ã®ã‚¹ãƒ©ã‚¤ãƒ‰ã‚·ãƒ§ãƒ¼ã§ã€å„å±¤ã®å½¹å‰²ã‚’ä¸€ç·’ã«è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ï¼</p>
                    <div class="layer-icon mt-6">ğŸŒ</div>
                `
            },
            {
                title: "ç¬¬7å±¤: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤",
                layerName: "Application Layer",
                icon: "ğŸ’»",
                iconClass: "icon-app",
                description: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç›´æ¥æ“ä½œã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã«æœ€ã‚‚è¿‘ã„å±¤ã§ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«è»¢é€ã€ãƒ¡ãƒ¼ãƒ«ã€ã‚¦ã‚§ãƒ–é–²è¦§ãªã©ã®æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚",
                protocols: "HTTP, FTP, SMTP, DNS, Telnet",
                analogy: "ä¾‹ãˆã‚‹ãªã‚‰ã€ã‚ãªãŸãŒä½¿ã†ã€Œã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®é¡”ã€ã€‚ã‚¦ã‚§ãƒ–ãƒ–ãƒ©ã‚¦ã‚¶ã‚„ãƒ¡ãƒ¼ãƒ«ã‚½ãƒ•ãƒˆãŒã“ã‚Œã«ã‚ãŸã‚Šã¾ã™ã€‚"
            },
            {
                title: "ç¬¬6å±¤: ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤",
                layerName: "Presentation Layer",
                icon: "ğŸ¨",
                iconClass: "icon-pres",
                description: "ãƒ‡ãƒ¼ã‚¿ã®è¡¨ç¾å½¢å¼ã‚’ç®¡ç†ã—ã¾ã™ã€‚æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›ã€ãƒ‡ãƒ¼ã‚¿ã®æš—å·åŒ–ãƒ»å¾©å·åŒ–ã€åœ§ç¸®ãƒ»è§£å‡ãªã©ã‚’è¡Œã„ã¾ã™ã€‚",
                protocols: "SSL/TLS, JPEG, GIF, ASCII, EBCDIC",
                analogy: "ä¾‹ãˆã‚‹ãªã‚‰ã€ã€Œç¿»è¨³å®¶å…¼ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ã€ã€‚ç›¸æ‰‹ã«ã‚ã‹ã‚‹è¨€è‘‰ã‚„å½¢ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ•´ãˆã¾ã™ã€‚"
            },
            {
                title: "ç¬¬5å±¤: ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤",
                layerName: "Session Layer",
                icon: "ğŸ¤",
                iconClass: "icon-sess",
                description: "é€šä¿¡ã®é–‹å§‹ã‹ã‚‰çµ‚äº†ã¾ã§ã®ä¸€é€£ã®æµã‚Œï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰ã‚’ç®¡ç†ã—ã¾ã™ã€‚åŒæœŸã‚’å–ã‚Šã€ãƒ‡ãƒ¼ã‚¿ã®é€å—ä¿¡ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãªã©ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚",
                protocols: "NetBIOS, RPC, PPTP",
                analogy: "ä¾‹ãˆã‚‹ãªã‚‰ã€ã€Œä¼šè©±ã®ç®¡ç†äººã€ã€‚é€šä¿¡ã®é–‹å§‹ã€é€”ä¸­ã§ã®ç¢ºèªã€çµ‚äº†ã®åˆå›³ãªã©ã‚’æ‹…å½“ã—ã¾ã™ã€‚"
            },
            {
                title: "ç¬¬4å±¤: ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤",
                layerName: "Transport Layer",
                icon: "ğŸšš",
                iconClass: "icon-trans",
                description: "ãƒ‡ãƒ¼ã‚¿ã®ä¿¡é ¼æ€§ã‚„åŠ¹ç‡çš„ãªè»¢é€ã‚’ä¿è¨¼ã—ã¾ã™ã€‚ã‚¨ãƒ©ãƒ¼è¨‚æ­£ã‚„å†é€åˆ¶å¾¡ã€ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã®ç¢ºç«‹ãªã©ã‚’è¡Œã„ã¾ã™ã€‚ãƒãƒ¼ãƒˆç•ªå·ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è­˜åˆ¥ã—ã¾ã™ã€‚",
                protocols: "TCP, UDP",
                analogy: "ä¾‹ãˆã‚‹ãªã‚‰ã€ã€Œé…é€æ¥­è€…ã€ã€‚è·ç‰©ï¼ˆãƒ‡ãƒ¼ã‚¿ï¼‰ã‚’ç¢ºå®Ÿã«ã€ã¾ãŸã¯ç´ æ—©ãç›¸æ‰‹ã®çª“å£ï¼ˆãƒãƒ¼ãƒˆï¼‰ã¾ã§å±Šã‘ã¾ã™ã€‚"
            },
            {
                title: "ç¬¬3å±¤: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤",
                layerName: "Network Layer",
                icon: "ğŸ—ºï¸",
                iconClass: "icon-net",
                description: "ç•°ãªã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é–“ã®ãƒ‡ãƒ¼ã‚¿è»¢é€ï¼ˆãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼‰ã‚’æ‹…å½“ã—ã¾ã™ã€‚IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä½¿ã£ã¦å®›å…ˆã‚’ç‰¹å®šã—ã€æœ€é©ãªçµŒè·¯ã‚’é¸æŠã—ã¾ã™ã€‚",
                protocols: "IP (IPv4, IPv6), ICMP, ARP, RIP, OSPF",
                analogy: "ä¾‹ãˆã‚‹ãªã‚‰ã€ã€Œéƒµä¾¿é…é”ã®ãƒ«ãƒ¼ãƒˆãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã€ã€‚ä½æ‰€ï¼ˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ã‚’è¦‹ã¦ã€æœ€é©ãªé“é †ã§æ‰‹ç´™ï¼ˆãƒ‡ãƒ¼ã‚¿ï¼‰ã‚’å±Šã‘ã¾ã™ã€‚"
            },
            {
                title: "ç¬¬2å±¤: ãƒ‡ãƒ¼ã‚¿ãƒªãƒ³ã‚¯å±¤",
                layerName: "Data Link Layer",
                icon: "ï¿½",
                iconClass: "icon-data",
                description: "ç›´æ¥æ¥ç¶šã•ã‚ŒãŸæ©Ÿå™¨é–“ã®ãƒ‡ãƒ¼ã‚¿è»¢é€ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚MACã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä½¿ã£ã¦é€šä¿¡ç›¸æ‰‹ã‚’è­˜åˆ¥ã—ã€ã‚¨ãƒ©ãƒ¼æ¤œå‡ºã‚‚è¡Œã„ã¾ã™ã€‚",
                protocols: "Ethernet, Wi-Fi, PPP, MACã‚¢ãƒ‰ãƒ¬ã‚¹, ãƒ•ãƒ¬ãƒ¼ãƒ ",
                analogy: "ä¾‹ãˆã‚‹ãªã‚‰ã€ã€Œéš£åŒå£«ã®ç›´æ¥ä¼šè©±ã€ã€‚ã™ãéš£ã®æ©Ÿå™¨ã«ç¢ºå®Ÿã«ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™å½¹å‰²ã§ã™ã€‚"
            },
            {
                title: "ç¬¬1å±¤: ç‰©ç†å±¤",
                layerName: "Physical Layer",
                icon: "ğŸ”Œ",
                iconClass: "icon-phys",
                description: "ãƒ‡ãƒ¼ã‚¿ã‚’é›»æ°—ä¿¡å·ã‚„å…‰ä¿¡å·ã«å¤‰æ›ã—ã€ã‚±ãƒ¼ãƒ–ãƒ«ãªã©ã®ç‰©ç†çš„ãªåª’ä½“ã‚’é€šã˜ã¦ä¼é€ã—ã¾ã™ã€‚ãƒ“ãƒƒãƒˆå˜ä½ã§ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã„ã¾ã™ã€‚",
                protocols: "ã‚¤ãƒ¼ã‚µãƒãƒƒãƒˆã‚±ãƒ¼ãƒ–ãƒ«, å…‰ãƒ•ã‚¡ã‚¤ãƒãƒ¼, ãƒãƒ–, ãƒªãƒ”ãƒ¼ã‚¿, RS-232C",
                analogy: "ä¾‹ãˆã‚‹ãªã‚‰ã€ã€Œé›»æ°—ä¿¡å·ãŒé€šã‚‹é“ãã®ã‚‚ã®ã€ã€‚ã‚±ãƒ¼ãƒ–ãƒ«ã‚„ã‚³ãƒã‚¯ã‚¿ã€é›»åœ§ã®ãƒ¬ãƒ™ãƒ«ãªã©ã‚’å®šç¾©ã—ã¾ã™ã€‚"
            },
            {
                title: "OSIå‚ç…§ãƒ¢ãƒ‡ãƒ« ã¾ã¨ã‚",
                content: `
                    <p>å„å±¤ãŒé€£æºã™ã‚‹ã“ã¨ã§ã€è¤‡é›‘ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€šä¿¡ãŒå®Ÿç¾ã•ã‚Œã¾ã™ã€‚</p>
                    <p>é€ä¿¡å´ã§ã¯ãƒ‡ãƒ¼ã‚¿ãŒç¬¬7å±¤ã‹ã‚‰ç¬¬1å±¤ã¸ã¨åŠ å·¥ã•ã‚Œã€å—ä¿¡å´ã§ã¯ç¬¬1å±¤ã‹ã‚‰ç¬¬7å±¤ã¸ã¨å…ƒã«æˆ»ã•ã‚Œã¦ã„ãã¾ã™ã€‚</p>
                    <div class="data-flow-animation" id="data-flow-animation-container">
                        <div class="layer-box-container">
                            <div class="layer-stack" id="sender-stack"> </div>
                            <div class="layer-stack" id="receiver-stack"> </div>
                        </div>
                        <div class="packet sender" id="packet-sender">Data</div>
                        <div class="packet receiver" id="packet-receiver" style="opacity:0;">Data</div>
                    </div>
                    <button id="play-animation-button" class="nav-button mt-4">ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å†ç”Ÿ</button>
                `
            }
        ];

        const slideContentArea = document.getElementById('slide-content-area');
        const prevButton = document.getElementById('prev-button');
        const nextButton = document.getElementById('next-button');
        const slideCounterElement = document.getElementById('slide-counter');

        let currentSlideIndex = 0; // åˆæœŸã‚¹ãƒ©ã‚¤ãƒ‰ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
        let slides = []; // ã‚¹ãƒ©ã‚¤ãƒ‰è¦ç´ ã‚’æ ¼ç´ã™ã‚‹é…åˆ—

        function createSlideDOM(slideData, index) {
            const slideDiv = document.createElement('div');
            slideDiv.classList.add('slide');
            slideDiv.id = `slide-${index}`;

            let innerHTML = `<h2>${slideData.title}</h2>`;
            if (slideData.layerName) {
                innerHTML += `<div class="layer-icon ${slideData.iconClass || ''}">${slideData.icon || 'â“'}</div>`;
                innerHTML += `<h3>${slideData.layerName}</h3>`;
                innerHTML += `<p>${slideData.description}</p>`;
                innerHTML += `<p class="keywords"><strong>ä¸»ãªãƒ—ãƒ­ãƒˆã‚³ãƒ«/æŠ€è¡“:</strong> ${slideData.protocols}</p>`;
                innerHTML += `<p class="analogy">${slideData.analogy}</p>`;
            } else if (slideData.content) {
                innerHTML += slideData.content;
            }
            slideDiv.innerHTML = innerHTML;
            return slideDiv;
        }

        function showSlide(index) {
            console.log(`Attempting to show slide: ${index}, current actual index: ${currentSlideIndex}`);
            const oldIndex = currentSlideIndex;

            if (index < 0 || index >= slides.length || (index === oldIndex && slides[index] && slides[index].classList.contains('active'))) {
                console.log("Show slide condition not met or slide already active.");
                return;
            }

            slides.forEach((slide, i) => {
                slide.classList.remove('active', 'prev-transition');
                if (i === oldIndex) {
                    if (index > oldIndex) {
                        slide.classList.add('prev-transition');
                         console.log(`Slide ${i} (old) is transitioning out left.`);
                    } else {
                        // For "back", the old slide (now to the right) fades out via default .slide styles
                        console.log(`Slide ${i} (old) is transitioning out right (default).`);
                    }
                }
            });

            if (slides[index]) {
                console.log(`Preparing to show new slide: ${index}`);
                if (index < oldIndex) { // Moving backward
                    slides[index].style.transform = 'translateX(-100%)';
                    console.log(`New slide ${index} set to translateX(-100%)`);
                } else { // Moving forward or initial load
                    slides[index].style.transform = 'translateX(100%)';
                    console.log(`New slide ${index} set to translateX(100%)`);
                }

                // Force reflow might help ensure the transform is applied before transition starts
                // slides[index].offsetHeight; 

                requestAnimationFrame(() => {
                    if (slides[index]) {
                        slides[index].classList.add('active');
                        console.log(`Slide ${index} class 'active' added.`);
                    }
                });
            } else {
                console.error(`Slide at index ${index} not found.`);
            }

            currentSlideIndex = index;
            updateNavigation();

            if (slidesData[index] && slidesData[index].title === "OSIå‚ç…§ãƒ¢ãƒ‡ãƒ« ã¾ã¨ã‚") {
                setupDataFlowAnimation();
                const playButton = document.getElementById('play-animation-button');
                if (playButton) {
                    playButton.onclick = playDataFlowAnimation;
                }
            }
        }


        function updateNavigation() {
            prevButton.disabled = currentSlideIndex === 0;
            nextButton.disabled = currentSlideIndex === slidesData.length - 1;
            slideCounterElement.textContent = `ã‚¹ãƒ©ã‚¤ãƒ‰ ${currentSlideIndex + 1} / ${slidesData.length}`;
            console.log(`Navigation updated. Current slide: ${currentSlideIndex + 1}`);
        }

        function initSlideshow() {
            console.log("Initializing slideshow...");
            if (!slideContentArea) {
                console.error("slideContentArea not found!");
                return;
            }
            slidesData.forEach((data, index) => {
                const slideElement = createSlideDOM(data, index);
                slideContentArea.appendChild(slideElement);
                slides.push(slideElement);
            });
            console.log(`${slides.length} slides created and pushed.`);
            showSlide(0); // Show the first slide
        }
        
        function setupDataFlowAnimation() {
            const senderStack = document.getElementById('sender-stack');
            const receiverStack = document.getElementById('receiver-stack');
            const layers = ["App", "Pres", "Sess", "Trans", "Net", "Data", "Phys"]; 

            if (!senderStack || !receiverStack) {
                console.warn("Sender/Receiver stack for animation not found.");
                return;
            }

            senderStack.innerHTML = ''; 
            receiverStack.innerHTML = ''; 

            layers.forEach(layer => {
                const senderBox = document.createElement('div');
                senderBox.classList.add('layer-box');
                senderBox.textContent = layer;
                senderBox.style.borderColor = getLayerColor(layer);
                senderStack.appendChild(senderBox);

                const receiverBox = document.createElement('div');
                receiverBox.classList.add('layer-box');
                receiverBox.textContent = layer;
                receiverBox.style.borderColor = getLayerColor(layer);
                receiverStack.appendChild(receiverBox);
            });
            console.log("Data flow animation layers setup.");
        }

        function getLayerColor(layerName) {
            const colors = {
                "App": "#ea580c", "Pres": "#ca8a04", "Sess": "#65a30d",
                "Trans": "#059669", "Net": "#0891b2", "Data": "#0284c7", "Phys": "#4f46e5"
            };
            return colors[layerName] || "#6b7280";
        }

        async function playDataFlowAnimation() {
            console.log("Playing data flow animation.");
            const packetSender = document.getElementById('packet-sender');
            const packetReceiver = document.getElementById('packet-receiver');
            const container = document.getElementById('data-flow-animation-container');
            if (!packetSender || !packetReceiver || !container) {
                console.error("Animation elements not found.");
                return;
            }

            const playButton = document.getElementById('play-animation-button');
            if(playButton) playButton.disabled = true;

            const containerRect = container.getBoundingClientRect();
            const initialTop = 10; 
            const finalTop = containerRect.height - packetSender.offsetHeight - 10; 
            const senderX = containerRect.width * 0.25 - (packetSender.offsetWidth / 2); 
            const receiverX = containerRect.width * 0.75 - (packetReceiver.offsetWidth / 2); 

            packetSender.style.opacity = '1';
            packetReceiver.style.opacity = '0';
            packetSender.style.top = `${initialTop}px`;
            packetSender.style.left = `${senderX}px`;
            packetReceiver.style.top = `${finalTop}px`;
            packetReceiver.style.left = `${receiverX}px`;

            packetSender.style.transition = 'top 2s ease-in-out, left 0.5s ease-in-out, opacity 0.5s ease-in-out';
            packetSender.style.top = `${finalTop}px`;
            console.log("Sender packet moving down.");

            await new Promise(resolve => setTimeout(resolve, 2000)); 

            packetSender.style.left = `${receiverX}px`;
            console.log("Sender packet moving across.");
            
            await new Promise(resolve => setTimeout(resolve, 500)); 

            packetSender.style.opacity = '0';
            packetReceiver.style.opacity = '1';
            packetReceiver.style.transition = 'top 2s ease-in-out, opacity 0.5s ease-in-out';
            console.log("Receiver packet appearing.");
            
            packetReceiver.style.top = `${initialTop}px`;
            console.log("Receiver packet moving up.");

            await new Promise(resolve => setTimeout(resolve, 2000)); 
            if(playButton) playButton.disabled = false;
            console.log("Data flow animation finished.");
        }

        prevButton.addEventListener('click', () => {
            if (currentSlideIndex > 0) {
                showSlide(currentSlideIndex - 1);
            }
        });

        nextButton.addEventListener('click', () => {
            if (currentSlideIndex < slidesData.length - 1) {
                showSlide(currentSlideIndex + 1);
            }
        });

        // --- ã‚¯ã‚¤ã‚ºé–‹å§‹ ---
        // DOMãŒå®Œå…¨ã«èª­ã¿è¾¼ã¾ã‚Œã¦ã‹ã‚‰åˆæœŸåŒ–å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initSlideshow);
        } else {
            initSlideshow(); // æ—¢ã«èª­ã¿è¾¼ã¿å®Œäº†ã®å ´åˆ
        }

    </script>
</body>
</html>
